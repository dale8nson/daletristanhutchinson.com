(self.webpackChunkdale_tristan_hutchinson=self.webpackChunkdale_tristan_hutchinson||[]).push([[678],{296:function(t){function e(t,e,s){var i,n,r,o,a;function h(){var l=Date.now()-o;l<e&&l>=0?i=setTimeout(h,e-l):(i=null,s||(a=t.apply(r,n),r=n=null))}null==e&&(e=100);var l=function(){r=this,n=arguments,o=Date.now();var l=s&&!i;return i||(i=setTimeout(h,e)),l&&(a=t.apply(r,n),r=n=null),a};return l.clear=function(){i&&(clearTimeout(i),i=null)},l.flush=function(){i&&(a=t.apply(r,n),r=n=null,clearTimeout(i),i=null)},l}e.debounce=e,t.exports=e},4391:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return Ft}});var i=s(7294),n=s(1550),r=s(9949),o=s(7462),a=s(9477),h=s(296),l=s.n(h);function c(t){let{debounce:e,scroll:s,polyfill:n,offsetSize:r}=void 0===t?{debounce:0,scroll:!1,offsetSize:!1}:t;const o=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,h]=(0,i.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,i.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),d=e?"number"==typeof e?e:e.scroll:null,u=e?"number"==typeof e?e:e.resize:null,p=(0,i.useRef)(!1);(0,i.useEffect)((()=>(p.current=!0,()=>{p.current=!1})));const[f,E,g]=(0,i.useMemo)((()=>{const t=()=>{if(!c.current.element)return;const{left:t,top:e,width:s,height:i,bottom:n,right:o,x:a,y:l}=c.current.element.getBoundingClientRect(),_={left:t,top:e,width:s,height:i,bottom:n,right:o,x:a,y:l};c.current.element instanceof HTMLElement&&r&&(_.height=c.current.element.offsetHeight,_.width=c.current.element.offsetWidth),Object.freeze(_),p.current&&!m(c.current.lastBounds,_)&&h(c.current.lastBounds=_)};return[t,u?l()(t,u):t,d?l()(t,d):t]}),[h,r,d,u]);function O(){c.current.scrollContainers&&(c.current.scrollContainers.forEach((t=>t.removeEventListener("scroll",g,!0))),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null)}function y(){c.current.element&&(c.current.resizeObserver=new o(g),c.current.resizeObserver.observe(c.current.element),s&&c.current.scrollContainers&&c.current.scrollContainers.forEach((t=>t.addEventListener("scroll",g,{capture:!0,passive:!0}))))}var T,v,C;return T=g,v=Boolean(s),(0,i.useEffect)((()=>{if(v){const t=T;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}}),[T,v]),C=E,(0,i.useEffect)((()=>{const t=C;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[C]),(0,i.useEffect)((()=>{O(),y()}),[s,g,E]),(0,i.useEffect)((()=>O),[]),[t=>{t&&t!==c.current.element&&(O(),c.current.element=t,c.current.scrollContainers=_(t),y())},a,f]}function _(t){const e=[];if(!t||t===document.body)return e;const{overflow:s,overflowX:i,overflowY:n}=window.getComputedStyle(t);return[s,i,n].some((t=>"auto"===t||"scroll"===t))&&e.push(t),[...e,..._(t.parentElement)]}const d=["x","y","top","bottom","left","right","width","height"],m=(t,e)=>d.every((s=>t[s]===e[s]));var u=Object.defineProperty,p=Object.defineProperties,f=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,y=(t,e,s)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,T=(t,e)=>{for(var s in e||(e={}))g.call(e,s)&&y(t,s,e[s]);if(E)for(var s of E(e))O.call(e,s)&&y(t,s,e[s]);return t};function v(t,e,s){if(!t)return;if(!0===s(t))return t;let i=e?t.return:t.child;for(;i;){const t=v(i,e,s);if(t)return t;i=e?null:i.sibling}}function C(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch(e){return t}}const U=C(i.createContext(null));class w extends i.Component{render(){return i.createElement(U.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:x,ReactCurrentDispatcher:L}=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function D(){const t=i.useContext(U);if(null===t)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=i.useId();return i.useMemo((()=>{for(const s of[null==x?void 0:x.current,t,null==t?void 0:t.alternate]){if(!s)continue;const t=v(s,!1,(t=>{let s=t.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}}));if(t)return t}}),[t,e])}function b(){const t=function(){var t,e;const s=D(),[n]=i.useState((()=>new Map));n.clear();let r=s;for(;r;){const s=null==(t=r.type)?void 0:t._context;s&&s!==U&&!n.has(s)&&n.set(s,null==(e=null==L?void 0:L.current)?void 0:e.readContext(C(s))),r=r.return}return n}();return i.useMemo((()=>Array.from(t.keys()).reduce(((e,s)=>n=>{return i.createElement(e,null,i.createElement(s.Provider,(r=T({},n),o={value:t.get(s)},p(r,f(o)))));var r,o}),(t=>i.createElement(w,T({},t))))),[t])}s(2576),s(6525),s(5431);const z={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function A(t){const{handlePointer:e}=(0,r.c)(t);return{priority:1,enabled:!0,compute(t,e,s){e.pointer.set(t.offsetX/e.size.width*2-1,-t.offsetY/e.size.height*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)},connected:void 0,handlers:Object.keys(z).reduce(((t,s)=>({...t,[s]:e(s)})),{}),update:()=>{var e;const{events:s,internal:i}=t.getState();null!=(e=i.lastEvent)&&e.current&&s.handlers&&s.handlers.onPointerMove(i.lastEvent.current)},connect:e=>{var s;const{set:i,events:n}=t.getState();null==n.disconnect||n.disconnect(),i((t=>({events:{...t.events,connected:e}}))),Object.entries(null!=(s=n.handlers)?s:[]).forEach((([t,s])=>{const[i,n]=z[t];e.addEventListener(i,s,{passive:n})}))},disconnect:()=>{const{set:e,events:s}=t.getState();var i;s.connected&&(Object.entries(null!=(i=s.handlers)?i:[]).forEach((([t,e])=>{if(s&&s.connected instanceof HTMLElement){const[i]=z[t];s.connected.removeEventListener(i,e)}})),e((t=>({events:{...t.events,connected:void 0}}))))}}}const S=i.forwardRef((function({children:t,fallback:e,resize:s,style:n,gl:h,events:l=A,eventSource:_,eventPrefix:d,shadows:m,linear:u,flat:p,legacy:f,orthographic:E,frameloop:g,dpr:O,performance:y,raycaster:T,camera:v,onPointerMissed:C,onCreated:U,...w},x){i.useMemo((()=>(0,r.e)(a)),[]);const L=b(),[D,z]=c({scroll:!0,debounce:{scroll:50,resize:0},...s}),S=i.useRef(null),P=i.useRef(null);i.useImperativeHandle(x,(()=>S.current));const R=(0,r.u)(C),[F,M]=i.useState(!1),[k,H]=i.useState(!1);if(F)throw F;if(k)throw k;const V=i.useRef(null);(0,r.a)((()=>{const e=S.current;z.width>0&&z.height>0&&e&&(V.current||(V.current=(0,r.b)(e)),V.current.configure({gl:h,events:l,shadows:m,linear:u,flat:p,legacy:f,orthographic:E,frameloop:g,dpr:O,performance:y,raycaster:T,camera:v,size:z,onPointerMissed:(...t)=>null==R.current?void 0:R.current(...t),onCreated:t=>{null==t.events.connect||t.events.connect(_?(0,r.i)(_)?_.current:_:P.current),d&&t.setEvents({compute:(t,e)=>{const s=t[d+"X"],i=t[d+"Y"];e.pointer.set(s/e.size.width*2-1,-i/e.size.height*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)}}),null==U||U(t)}}),V.current.render(i.createElement(L,null,i.createElement(r.E,{set:H},i.createElement(i.Suspense,{fallback:i.createElement(r.B,{set:M})},t)))))})),i.useEffect((()=>{const t=S.current;if(t)return()=>(0,r.d)(t)}),[]);const Y=_?"none":"auto";return i.createElement("div",(0,o.Z)({ref:P,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...n}},w),i.createElement("div",{ref:D,style:{width:"100%",height:"100%"}},i.createElement("canvas",{ref:S,style:{display:"block"}},e)))})),P=i.forwardRef((function(t,e){return i.createElement(w,null,i.createElement(S,(0,o.Z)({},t,{ref:e})))})),R=1,F=2,M=4,k=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),H=0,V=1,Y=-1;function Z(t){return t.isPerspectiveCamera}function B(t){return t.isOrthographicCamera}const I=2*Math.PI,N=Math.PI/2,X=1e-5,K=Math.PI/180;function Q(t,e,s){return Math.max(e,Math.min(s,t))}function j(t,e=X){return Math.abs(t)<e}function q(t,e,s=X){return j(t-e,s)}function W(t,e){return Math.round(t/e)*e}function J(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function $(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function G(t,e,s,i,n=1/0,r){const o=2/(i=Math.max(1e-4,i)),a=o*r,h=1/(1+a+.48*a*a+.235*a*a*a);let l=t-e;const c=e,_=n*i;l=Q(l,-_,_),e=t-l;const d=(s.value+o*l)*r;s.value=(s.value-o*d)*h;let m=e+(l+d)*h;return c-t>0==m>c&&(m=c,s.value=(m-c)/r),m}function tt(t,e,s,i,n=1/0,r,o){const a=2/(i=Math.max(1e-4,i)),h=a*r,l=1/(1+h+.48*h*h+.235*h*h*h);let c=e.x,_=e.y,d=e.z,m=t.x-c,u=t.y-_,p=t.z-d;const f=c,E=_,g=d,O=n*i,y=m*m+u*u+p*p;if(y>O*O){const t=Math.sqrt(y);m=m/t*O,u=u/t*O,p=p/t*O}c=t.x-m,_=t.y-u,d=t.z-p;const T=(s.x+a*m)*r,v=(s.y+a*u)*r,C=(s.z+a*p)*r;s.x=(s.x-a*T)*l,s.y=(s.y-a*v)*l,s.z=(s.z-a*C)*l,o.x=c+(m+T)*l,o.y=_+(u+v)*l,o.z=d+(p+C)*l;const U=f-t.x,w=E-t.y,x=g-t.z;return U*(o.x-f)+w*(o.y-E)+x*(o.z-g)>0&&(o.x=f,o.y=E,o.z=g,s.x=(o.x-f)/r,s.y=(o.y-E)/r,s.z=(o.z-g)/r),o}function et(t,e){e.set(0,0),t.forEach((t=>{e.x+=t.clientX,e.y+=t.clientY})),e.x/=t.length,e.y/=t.length}function st(t,e){return!!B(t)&&(console.warn(`${e} is not supported in OrthographicCamera`),!0)}class it{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;void 0===s[t]&&(s[t]=[]),-1===s[t].indexOf(e)&&s[t].push(e)}hasEventListener(t,e){const s=this._listeners;return void 0!==s[t]&&-1!==s[t].indexOf(e)}removeEventListener(t,e){const s=this._listeners[t];if(void 0!==s){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}removeAllEventListeners(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}}dispatchEvent(t){const e=this._listeners[t.type];if(void 0!==e){t.target=this;const s=e.slice(0);for(let e=0,i=s.length;e<i;e++)s[e].call(this,t)}}}const nt=1/8,rt="undefined"!=typeof window,ot=rt&&/Mac/.test(navigator.platform),at=!(rt&&"PointerEvent"in window);let ht,lt,ct,_t,dt,mt,ut,pt,ft,Et,gt,Ot,yt,Tt,vt,Ct,Ut,wt,xt,Lt,Dt,bt,zt;class At extends it{static install(t){ht=t.THREE,lt=Object.freeze(new ht.Vector3(0,0,0)),ct=Object.freeze(new ht.Vector3(0,1,0)),_t=Object.freeze(new ht.Vector3(0,0,1)),dt=new ht.Vector2,mt=new ht.Vector3,ut=new ht.Vector3,pt=new ht.Vector3,ft=new ht.Vector3,Et=new ht.Vector3,gt=new ht.Vector3,Ot=new ht.Vector3,yt=new ht.Vector3,Tt=new ht.Vector3,vt=new ht.Spherical,Ct=new ht.Spherical,Ut=new ht.Box3,wt=new ht.Box3,xt=new ht.Sphere,Lt=new ht.Quaternion,Dt=new ht.Quaternion,bt=new ht.Matrix4,zt=new ht.Raycaster}static get ACTION(){return k}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=k.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=H,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new ht.Vector3,this._focalOffsetVelocity=new ht.Vector3,this._zoomVelocity={value:0},this._truckInternal=(t,e,s)=>{let i,n;if(Z(this._camera)){const s=mt.copy(this._camera.position).sub(this._target),r=this._camera.getEffectiveFOV()*K,o=s.length()*Math.tan(.5*r);i=this.truckSpeed*t*o/this._elementRect.height,n=this.truckSpeed*e*o/this._elementRect.height}else{if(!B(this._camera))return;{const s=this._camera;i=t*(s.right-s.left)/s.zoom/this._elementRect.width,n=e*(s.top-s.bottom)/s.zoom/this._elementRect.height}}this.verticalDragToForward?(s?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(i,0,!0),this.forward(-n,!0)):s?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y+n,this._focalOffsetEnd.z,!0):this.truck(i,n,!0)},this._rotateInternal=(t,e)=>{const s=I*this.azimuthRotateSpeed*t/this._elementRect.height,i=I*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(s,i,!0)},this._dollyInternal=(t,e,s)=>{const i=Math.pow(.95,-t*this.dollySpeed),n=this._sphericalEnd.radius,r=this._sphericalEnd.radius*i,o=Q(r,this.minDistance,this.maxDistance),a=o-r;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(r,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(o,!0)):this._dollyToNoClamp(o,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?r:o)-n,this._dollyControlCoord.set(e,s)),this._lastDollyDirection=Math.sign(-t)},this._zoomInternal=(t,e,s)=>{const i=Math.pow(.95,t*this.dollySpeed),n=this._zoom,r=this._zoom*i;this.zoomTo(r,!0),this.dollyToCursor&&(this._changedZoom+=r-n,this._dollyControlCoord.set(e,s))},void 0===ht&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new ht.Quaternion).setFromUnitVectors(this._camera.up,ct),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=k.NONE,this._target=new ht.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new ht.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new ht.Spherical).setFromVector3(mt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new ht.Vector3,new ht.Vector3,new ht.Vector3,new ht.Vector3],this._updateNearPlaneCorners(),this._boundary=new ht.Box3(new ht.Vector3(-1/0,-1/0,-1/0),new ht.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new ht.Vector2,this.mouseButtons={left:k.ROTATE,middle:k.DOLLY,right:k.TRUCK,wheel:Z(this._camera)?k.DOLLY:B(this._camera)?k.ZOOM:k.NONE},this.touches={one:k.TOUCH_ROTATE,two:Z(this._camera)?k.TOUCH_DOLLY_TRUCK:B(this._camera)?k.TOUCH_ZOOM_TRUCK:k.NONE,three:k.TOUCH_TRUCK};const s=new ht.Vector2,i=new ht.Vector2,n=new ht.Vector2,r=t=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const e=this._domElement.getBoundingClientRect(),s=t.clientX/e.width,i=t.clientY/e.height;if(s<this._interactiveArea.left||s>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}const e="mouse"!==t.pointerType?null:(t.buttons&R)===R?R:(t.buttons&M)===M?M:(t.buttons&F)===F?F:null;if(null!==e){const t=this._findPointerByMouseButton(e);t&&this._disposePointer(t)}if((t.buttons&R)===R&&this._lockedPointer)return;const s={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:e};this._activePointers.push(s),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),this._isDragging=!0,u(t)},o=t=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const e=this._domElement.getBoundingClientRect(),s=t.clientX/e.width,i=t.clientY/e.height;if(s<this._interactiveArea.left||s>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}const e=(t.buttons&R)===R?R:(t.buttons&M)===M?M:(t.buttons&F)===F?F:null;if(null!==e){const t=this._findPointerByMouseButton(e);t&&this._disposePointer(t)}const s={pointerId:1,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:(t.buttons&R)===R?R:(t.buttons&M)===R?M:(t.buttons&F)===R?F:null};this._activePointers.push(s),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("mouseup",c),this._domElement.ownerDocument.addEventListener("mousemove",h),this._domElement.ownerDocument.addEventListener("mouseup",c),this._isDragging=!0,u(t)},a=t=>{t.cancelable&&t.preventDefault();const e=t.pointerId,s=this._lockedPointer||this._findPointerById(e);if(s){if(s.clientX=t.clientX,s.clientY=t.clientY,s.deltaX=t.movementX,s.deltaY=t.movementY,this._state=0,"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(t.buttons&R)===R)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(t.buttons&F)===F&&(this._state=this._state|this.mouseButtons.right);p()}},h=t=>{const e=this._lockedPointer||this._findPointerById(1);e&&(e.clientX=t.clientX,e.clientY=t.clientY,e.deltaX=t.movementX,e.deltaY=t.movementY,this._state=0,(this._lockedPointer||(t.buttons&R)===R)&&(this._state=this._state|this.mouseButtons.left),(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&F)===F&&(this._state=this._state|this.mouseButtons.right),p())},l=t=>{const e=this._findPointerById(t.pointerId);if(!e||e!==this._lockedPointer){if(e&&this._disposePointer(e),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=k.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=k.NONE;f()}},c=()=>{const t=this._findPointerById(1);t&&t===this._lockedPointer||(t&&this._disposePointer(t),this._state=k.NONE,f())};let _=-1;const d=t=>{if(!this._domElement)return;if(!this._enabled||this.mouseButtons.wheel===k.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const e=this._domElement.getBoundingClientRect(),s=t.clientX/e.width,i=t.clientY/e.height;if(s<this._interactiveArea.left||s>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===k.ROTATE||this.mouseButtons.wheel===k.TRUCK){const t=performance.now();_-t<1e3&&this._getClientRect(this._elementRect),_=t}const e=ot?-1:-3,s=1===t.deltaMode?t.deltaY/e:t.deltaY/(10*e),i=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,n=this.dollyToCursor?(t.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case k.ROTATE:this._rotateInternal(t.deltaX,t.deltaY),this._isUserControllingRotate=!0;break;case k.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1),this._isUserControllingTruck=!0;break;case k.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0),this._isUserControllingOffset=!0;break;case k.DOLLY:this._dollyInternal(-s,i,n),this._isUserControllingDolly=!0;break;case k.ZOOM:this._zoomInternal(-s,i,n),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},m=t=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===At.ACTION.NONE){const e=t instanceof PointerEvent?t.pointerId:(MouseEvent,0),s=this._findPointerById(e);return s&&this._disposePointer(s),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("mousemove",h),void this._domElement.ownerDocument.removeEventListener("mouseup",c)}t.preventDefault()}},u=t=>{if(!this._enabled)return;et(this._activePointers,dt),this._getClientRect(this._elementRect),s.copy(dt),i.copy(dt);if(this._activePointers.length>=2){const t=dt.x-this._activePointers[1].clientX,e=dt.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e);n.set(0,s);const r=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),o=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);i.set(r,o)}if(this._state=0,t)if("pointerType"in t&&"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(t.buttons&R)!==R||(this._state=this._state|this.mouseButtons.left),(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&F)===F&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);(this._state&k.ROTATE)!==k.ROTATE&&(this._state&k.TOUCH_ROTATE)!==k.TOUCH_ROTATE&&(this._state&k.TOUCH_DOLLY_ROTATE)!==k.TOUCH_DOLLY_ROTATE&&(this._state&k.TOUCH_ZOOM_ROTATE)!==k.TOUCH_ZOOM_ROTATE||(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),(this._state&k.TRUCK)!==k.TRUCK&&(this._state&k.TOUCH_TRUCK)!==k.TOUCH_TRUCK&&(this._state&k.TOUCH_DOLLY_TRUCK)!==k.TOUCH_DOLLY_TRUCK&&(this._state&k.TOUCH_ZOOM_TRUCK)!==k.TOUCH_ZOOM_TRUCK||(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),(this._state&k.DOLLY)!==k.DOLLY&&(this._state&k.TOUCH_DOLLY)!==k.TOUCH_DOLLY&&(this._state&k.TOUCH_DOLLY_TRUCK)!==k.TOUCH_DOLLY_TRUCK&&(this._state&k.TOUCH_DOLLY_OFFSET)!==k.TOUCH_DOLLY_OFFSET&&(this._state&k.TOUCH_DOLLY_ROTATE)!==k.TOUCH_DOLLY_ROTATE||(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),(this._state&k.ZOOM)!==k.ZOOM&&(this._state&k.TOUCH_ZOOM)!==k.TOUCH_ZOOM&&(this._state&k.TOUCH_ZOOM_TRUCK)!==k.TOUCH_ZOOM_TRUCK&&(this._state&k.TOUCH_ZOOM_OFFSET)!==k.TOUCH_ZOOM_OFFSET&&(this._state&k.TOUCH_ZOOM_ROTATE)!==k.TOUCH_ZOOM_ROTATE||(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),(this._state&k.OFFSET)!==k.OFFSET&&(this._state&k.TOUCH_OFFSET)!==k.TOUCH_OFFSET&&(this._state&k.TOUCH_DOLLY_OFFSET)!==k.TOUCH_DOLLY_OFFSET&&(this._state&k.TOUCH_ZOOM_OFFSET)!==k.TOUCH_ZOOM_OFFSET||(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},p=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,et(this._activePointers,dt);const t=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,e=t?-t.deltaX:i.x-dt.x,r=t?-t.deltaY:i.y-dt.y;if(i.copy(dt),(this._state&k.ROTATE)!==k.ROTATE&&(this._state&k.TOUCH_ROTATE)!==k.TOUCH_ROTATE&&(this._state&k.TOUCH_DOLLY_ROTATE)!==k.TOUCH_DOLLY_ROTATE&&(this._state&k.TOUCH_ZOOM_ROTATE)!==k.TOUCH_ZOOM_ROTATE||(this._rotateInternal(e,r),this._isUserControllingRotate=!0),(this._state&k.DOLLY)===k.DOLLY||(this._state&k.ZOOM)===k.ZOOM){const t=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,e=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0,i=this.dollyDragInverted?-1:1;(this._state&k.DOLLY)===k.DOLLY?(this._dollyInternal(i*r*nt,t,e),this._isUserControllingDolly=!0):(this._zoomInternal(i*r*nt,t,e),this._isUserControllingZoom=!0)}if((this._state&k.TOUCH_DOLLY)===k.TOUCH_DOLLY||(this._state&k.TOUCH_ZOOM)===k.TOUCH_ZOOM||(this._state&k.TOUCH_DOLLY_TRUCK)===k.TOUCH_DOLLY_TRUCK||(this._state&k.TOUCH_ZOOM_TRUCK)===k.TOUCH_ZOOM_TRUCK||(this._state&k.TOUCH_DOLLY_OFFSET)===k.TOUCH_DOLLY_OFFSET||(this._state&k.TOUCH_ZOOM_OFFSET)===k.TOUCH_ZOOM_OFFSET||(this._state&k.TOUCH_DOLLY_ROTATE)===k.TOUCH_DOLLY_ROTATE||(this._state&k.TOUCH_ZOOM_ROTATE)===k.TOUCH_ZOOM_ROTATE){const t=dt.x-this._activePointers[1].clientX,e=dt.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e),r=n.y-s;n.set(0,s);const o=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&k.TOUCH_DOLLY)===k.TOUCH_DOLLY||(this._state&k.TOUCH_DOLLY_ROTATE)===k.TOUCH_DOLLY_ROTATE||(this._state&k.TOUCH_DOLLY_TRUCK)===k.TOUCH_DOLLY_TRUCK||(this._state&k.TOUCH_DOLLY_OFFSET)===k.TOUCH_DOLLY_OFFSET?(this._dollyInternal(r*nt,o,a),this._isUserControllingDolly=!0):(this._zoomInternal(r*nt,o,a),this._isUserControllingZoom=!0)}(this._state&k.TRUCK)!==k.TRUCK&&(this._state&k.TOUCH_TRUCK)!==k.TOUCH_TRUCK&&(this._state&k.TOUCH_DOLLY_TRUCK)!==k.TOUCH_DOLLY_TRUCK&&(this._state&k.TOUCH_ZOOM_TRUCK)!==k.TOUCH_ZOOM_TRUCK||(this._truckInternal(e,r,!1),this._isUserControllingTruck=!0),(this._state&k.OFFSET)!==k.OFFSET&&(this._state&k.TOUCH_OFFSET)!==k.TOUCH_OFFSET&&(this._state&k.TOUCH_DOLLY_OFFSET)!==k.TOUCH_DOLLY_OFFSET&&(this._state&k.TOUCH_ZOOM_OFFSET)!==k.TOUCH_ZOOM_OFFSET||(this._truckInternal(e,r,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},f=()=>{et(this._activePointers,dt),i.copy(dt),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("mouseup",c),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",E),this._domElement.ownerDocument.addEventListener("pointerlockerror",g),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),u())},this.unlockPointer=()=>{null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))};const E=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},g=()=>{this.unlockPointer()};this._addAllEventListeners=t=>{this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",r),at&&this._domElement.addEventListener("mousedown",o),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",d,{passive:!1}),this._domElement.addEventListener("contextmenu",m)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",r),this._domElement.removeEventListener("mousedown",o),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",d,{passive:!1}),this._domElement.removeEventListener("contextmenu",m),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",h),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("mouseup",c),this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))},this.cancel=()=>{this._state!==k.NONE&&(this._state=k.NONE,this._activePointers.length=0,f())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=Q(t.width,0,1),this._interactiveArea.height=Q(t.height,0,1),this._interactiveArea.x=Q(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Q(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){this._isUserControllingRotate=!1;const i=Q(t,this.minAzimuthAngle,this.maxAzimuthAngle),n=Q(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const r=!s||q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(r)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=H,this._changedDolly=0,this._dollyToNoClamp(Q(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const s=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const e=this._collisionTest(),i=q(e,this._spherical.radius);if(!(s>t)&&i)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,e)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const i=!e||q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(ft).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const s=!e||q(this._target.x,this._targetEnd.x,this.restThreshold)&&q(this._target.y,this._targetEnd.y,this.restThreshold)&&q(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=Q(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||q(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),Et.setFromMatrixColumn(this._camera.matrix,0),gt.setFromMatrixColumn(this._camera.matrix,1),Et.multiplyScalar(t),gt.multiplyScalar(-e);const i=mt.copy(Et).add(gt),n=ut.copy(this._targetEnd).add(i);return this.moveTo(n.x,n.y,n.z,s)}forward(t,e=!1){mt.setFromMatrixColumn(this._camera.matrix,0),mt.crossVectors(this._camera.up,mt),mt.multiplyScalar(t);const s=ut.copy(this._targetEnd).add(mt);return this.moveTo(s.x,s.y,s.z,e)}elevate(t,e=!1){return mt.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+mt.x,this._targetEnd.y+mt.y,this._targetEnd.z+mt.z,e)}moveTo(t,e,s,i=!1){this._isUserControllingTruck=!1;const n=mt.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const r=!i||q(this._target.x,this._targetEnd.x,this.restThreshold)&&q(this._target.y,this._targetEnd.y,this.restThreshold)&&q(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}lookInDirectionOf(t,e,s,i=!1){const n=mt.set(t,e,s).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(n.x,n.y,n.z,i)}fitToBox(t,e,{cover:s=!1,paddingLeft:i=0,paddingRight:n=0,paddingBottom:r=0,paddingTop:o=0}={}){const a=[],h=t.isBox3?Ut.copy(t):Ut.setFromObject(t);h.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const l=W(this._sphericalEnd.theta,N),c=W(this._sphericalEnd.phi,N);a.push(this.rotateTo(l,c,e));const _=mt.setFromSpherical(this._sphericalEnd).normalize(),d=Lt.setFromUnitVectors(_,_t),m=q(Math.abs(_.y),1);m&&d.multiply(Dt.setFromAxisAngle(ct,l)),d.multiply(this._yAxisUpSpaceInverse);const u=wt.makeEmpty();ut.copy(h.min).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.min).setX(h.max.x).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.min).setY(h.max.y).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.max).setZ(h.min.z).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.min).setZ(h.max.z).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.max).setY(h.min.y).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.max).setX(h.min.x).applyQuaternion(d),u.expandByPoint(ut),ut.copy(h.max).applyQuaternion(d),u.expandByPoint(ut),u.min.x-=i,u.min.y-=r,u.max.x+=n,u.max.y+=o,d.setFromUnitVectors(_t,_),m&&d.premultiply(Dt.invert()),d.premultiply(this._yAxisUpSpace);const p=u.getSize(mt),f=u.getCenter(ut).applyQuaternion(d);if(Z(this._camera)){const t=this.getDistanceToFitBox(p.x,p.y,p.z,s);a.push(this.moveTo(f.x,f.y,f.z,e)),a.push(this.dollyTo(t,e)),a.push(this.setFocalOffset(0,0,0,e))}else if(B(this._camera)){const t=this._camera,i=t.right-t.left,n=t.top-t.bottom,r=s?Math.max(i/p.x,n/p.y):Math.min(i/p.x,n/p.y);a.push(this.moveTo(f.x,f.y,f.z,e)),a.push(this.zoomTo(r,e)),a.push(this.setFocalOffset(0,0,0,e))}return Promise.all(a)}fitToSphere(t,e){const s=[],i=t instanceof ht.Sphere?xt.copy(t):At.createBoundingSphere(t,xt);if(s.push(this.moveTo(i.center.x,i.center.y,i.center.z,e)),Z(this._camera)){const t=this.getDistanceToFitSphere(i.radius);s.push(this.dollyTo(t,e))}else if(B(this._camera)){const t=this._camera.right-this._camera.left,n=this._camera.top-this._camera.bottom,r=2*i.radius,o=Math.min(t/r,n/r);s.push(this.zoomTo(o,e))}return s.push(this.setFocalOffset(0,0,0,e)),Promise.all(s)}setLookAt(t,e,s,i,n,r,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=H,this._changedDolly=0;const a=ut.set(i,n,r),h=mt.set(t,e,s);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(h.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const l=!o||q(this._target.x,this._targetEnd.x,this.restThreshold)&&q(this._target.y,this._targetEnd.y,this.restThreshold)&&q(this._target.z,this._targetEnd.z,this.restThreshold)&&q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(l)}lerpLookAt(t,e,s,i,n,r,o,a,h,l,c,_,d,m=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=H,this._changedDolly=0;const u=mt.set(i,n,r),p=ut.set(t,e,s);vt.setFromVector3(p.sub(u).applyQuaternion(this._yAxisUpSpace));const f=pt.set(l,c,_),E=ut.set(o,a,h);Ct.setFromVector3(E.sub(f).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(u.lerp(f,d));const g=Ct.theta-vt.theta,O=Ct.phi-vt.phi,y=Ct.radius-vt.radius;this._sphericalEnd.set(vt.radius+y*d,vt.phi+O*d,vt.theta+g*d),this.normalizeRotations(),this._needsUpdate=!0,m||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const T=!m||q(this._target.x,this._targetEnd.x,this.restThreshold)&&q(this._target.y,this._targetEnd.y,this.restThreshold)&&q(this._target.z,this._targetEnd.z,this.restThreshold)&&q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(T)}setPosition(t,e,s,i=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(t,e,s,i=!1){const n=this.getPosition(mt),r=this.setLookAt(n.x,n.y,n.z,t,e,s,i);return this._sphericalEnd.phi=Q(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),r}setFocalOffset(t,e,s,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const n=!i||q(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&q(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&q(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(t,e,s){this._camera.updateMatrixWorld(),Et.setFromMatrixColumn(this._camera.matrixWorldInverse,0),gt.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Ot.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=mt.set(t,e,s),n=i.distanceTo(this._camera.position),r=i.sub(this._camera.position);Et.multiplyScalar(r.x),gt.multiplyScalar(r.y),Ot.multiplyScalar(r.z),mt.copy(Et).add(gt).add(Ot),mt.z=mt.z+n,this.dollyTo(n,!1),this.setFocalOffset(-mt.x,mt.y,-mt.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,i){null!==t?(this._viewport=this._viewport||new ht.Vector4,"number"==typeof t?this._viewport.set(t,e,s,i):this._viewport.copy(t)):this._viewport=null}getDistanceToFitBox(t,e,s,i=!1){if(st(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=t/e,r=this._camera.getEffectiveFOV()*K,o=this._camera.aspect;return.5*((i?n>o:n<o)?e:t/o)/Math.tan(.5*r)+.5*s}getDistanceToFitSphere(t){if(st(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*K,s=2*Math.atan(Math.tan(.5*e)*this._camera.aspect),i=1<this._camera.aspect?e:s;return t/Math.sin(.5*i)}getTarget(t,e=!0){return(t&&t.isVector3?t:new ht.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new ht.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t&&t instanceof ht.Spherical?t:new ht.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new ht.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%I,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=I),this._spherical.theta+=I*Math.round((this._sphericalEnd.theta-this._spherical.theta)/I)}reset(t=!1){if(!q(this._camera.up.x,this._cameraUp0.x)||!q(this._camera.up.y,this._cameraUp0.y)||!q(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const t=this.getPosition(mt);this.updateCameraUp(),this.setPosition(t.x,t.y,t.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,ct),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=mt.subVectors(this._target,this._camera.position).normalize(),e=ut.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const s=this.getPosition(mt);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,s=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,n=yt.subVectors(this._targetEnd,this._target),r=Tt.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(j(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=G(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,e,1/0,t),this._needsUpdate=!0}if(j(s))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=G(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,e,1/0,t),this._needsUpdate=!0}if(j(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const e=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=G(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,e,this.maxSpeed,t),this._needsUpdate=!0}if(j(n.x)&&j(n.y)&&j(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const e=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;tt(this._target,this._targetEnd,this._targetVelocity,e,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(j(r.x)&&j(r.y)&&j(r.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const e=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;tt(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,e,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(j(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const e=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=G(this._zoom,this._zoomEnd,this._zoomVelocity,e,1/0,t)}if(this.dollyToCursor)if(Z(this._camera)&&0!==this._changedDolly){const t=this._spherical.radius-this._lastDistance,e=this._camera,s=this._getCameraDirection(ft),i=mt.copy(s).cross(e.up).normalize();0===i.lengthSq()&&(i.x=1);const n=ut.crossVectors(i,s),r=this._sphericalEnd.radius*Math.tan(e.getEffectiveFOV()*K*.5),o=(this._sphericalEnd.radius-t-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=pt.copy(this._targetEnd).add(i.multiplyScalar(this._dollyControlCoord.x*r*e.aspect)).add(n.multiplyScalar(this._dollyControlCoord.y*r)),h=mt.copy(this._targetEnd).lerp(a,o),l=this._lastDollyDirection===V&&this._spherical.radius<=this.minDistance,c=this._lastDollyDirection===Y&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(l||c)){this._sphericalEnd.radius-=t,this._spherical.radius-=t;const e=ut.copy(s).multiplyScalar(-t);h.add(e)}this._boundary.clampPoint(h,h);const _=ut.subVectors(h,this._targetEnd);this._targetEnd.copy(h),this._target.add(_),this._changedDolly-=t,j(this._changedDolly)&&(this._changedDolly=0)}else if(B(this._camera)&&0!==this._changedZoom){const t=this._zoom-this._lastZoom,e=this._camera,s=mt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(e.near+e.far)/(e.near-e.far)).unproject(e),i=ut.set(0,0,-1).applyQuaternion(e.quaternion),n=pt.copy(s).add(i.multiplyScalar(-s.dot(e.up))),r=-(this._zoom-t-this._zoom)/this._zoom,o=this._getCameraDirection(ft),a=this._targetEnd.dot(o),h=mt.copy(this._targetEnd).lerp(n,r),l=h.dot(o),c=o.multiplyScalar(l-a);h.sub(c),this._boundary.clampPoint(h,h);const _=ut.subVectors(h,this._targetEnd);this._targetEnd.copy(h),this._target.add(_),this._changedZoom-=t,j(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target);(!j(this._focalOffset.x)||!j(this._focalOffset.y)||!j(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Et.setFromMatrixColumn(this._camera.matrix,0),gt.setFromMatrixColumn(this._camera.matrix,1),Ot.setFromMatrixColumn(this._camera.matrix,2),Et.multiplyScalar(this._focalOffset.x),gt.multiplyScalar(-this._focalOffset.y),Ot.multiplyScalar(this._focalOffset.z),mt.copy(Et).add(gt).add(Ot),this._camera.position.add(mt)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),mt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const h=this._needsUpdate;return h&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):h?(this.dispatchEvent({type:"update"}),j(e,this.restThreshold)&&j(s,this.restThreshold)&&j(i,this.restThreshold)&&j(n.x,this.restThreshold)&&j(n.y,this.restThreshold)&&j(n.z,this.restThreshold)&&j(r.x,this.restThreshold)&&j(r.y,this.restThreshold)&&j(r.z,this.restThreshold)&&j(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!h&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=h,this._needsUpdate=!1,h}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:J(this.maxDistance),minZoom:this.minZoom,maxZoom:J(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:J(this.maxPolarAngle),minAzimuthAngle:J(this.minAzimuthAngle),maxAzimuthAngle:J(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:mt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=$(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=$(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=$(s.maxPolarAngle),this.minAzimuthAngle=$(s.minAzimuthAngle),this.maxAzimuthAngle=$(s.maxAzimuthAngle),this.smoothTime=s.smoothTime,this.draggingSmoothTime=s.draggingSmoothTime,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),vt.setFromVector3(mt.fromArray(s.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(vt.theta,vt.phi,e),this.dollyTo(vt.radius,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}connect(t){this._domElement?console.warn("camera-controls is already connected."):(t.setAttribute("data-camera-controls-version","2.7.3"),this._addAllEventListeners(t),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find((e=>e.pointerId===t))}_findPointerByMouseButton(t){return this._activePointers.find((e=>e.mouseButton===t))}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,s){const i=e.lengthSq();if(0===i)return t;const n=ut.copy(e).add(t),r=this._boundary.clampPoint(n,pt).sub(n),o=r.lengthSq();if(0===o)return t.add(e);if(o===i)return t;if(0===s)return t.add(e).add(r);{const i=1+s*o/e.dot(r);return t.add(ut.copy(e).multiplyScalar(i)).add(r.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(Z(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*K,i=Math.tan(.5*s)*e,n=i*t.aspect;this._nearPlaneCorners[0].set(-n,-i,0),this._nearPlaneCorners[1].set(n,-i,0),this._nearPlaneCorners[2].set(n,i,0),this._nearPlaneCorners[3].set(-n,i,0)}else if(B(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,i=t.right*e,n=t.top*e,r=t.bottom*e;this._nearPlaneCorners[0].set(s,n,0),this._nearPlaneCorners[1].set(i,n,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(s,r,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1))return t;if(st(this._camera,"_collisionTest"))return t;const e=this._getTargetDirection(ft);bt.lookAt(lt,e,this._camera.up);for(let s=0;s<4;s++){const i=ut.copy(this._nearPlaneCorners[s]);i.applyMatrix4(bt);const n=pt.addVectors(this._target,i);zt.set(n,e),zt.far=this._spherical.radius+1;const r=zt.intersectObjects(this.colliderMeshes);0!==r.length&&r[0].distance<t&&(t=r[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((t=>{const e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)})))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new ht.Sphere){const s=e,i=s.center;Ut.makeEmpty(),t.traverseVisible((t=>{t.isMesh&&Ut.expandByObject(t)})),Ut.getCenter(i);let n=0;return t.traverseVisible((t=>{if(!t.isMesh)return;const e=t,s=e.geometry.clone();s.applyMatrix4(e.matrixWorld);const r=s.attributes.position;for(let o=0,a=r.count;o<a;o++)mt.fromBufferAttribute(r,o),n=Math.max(n,i.distanceToSquared(mt))})),s.radius=Math.sqrt(n),s}}const St=(0,i.forwardRef)(((t,e)=>{(0,i.useMemo)((()=>{const t={Box3:a.Box3,MathUtils:{clamp:a.MathUtils.clamp},Matrix4:a.Matrix4,Quaternion:a.Quaternion,Raycaster:a.Raycaster,Sphere:a.Sphere,Spherical:a.Spherical,Vector2:a.Vector2,Vector3:a.Vector3,Vector4:a.Vector4};At.install({THREE:t}),(0,r.e)({CameraControlsImpl:At})}),[]);const{camera:s,domElement:n,makeDefault:h,onStart:l,onEnd:c,onChange:_,regress:d,...m}=t,u=(0,r.z)((t=>t.camera)),p=(0,r.z)((t=>t.gl)),f=(0,r.z)((t=>t.invalidate)),E=(0,r.z)((t=>t.events)),g=(0,r.z)((t=>t.setEvents)),O=(0,r.z)((t=>t.set)),y=(0,r.z)((t=>t.get)),T=(0,r.z)((t=>t.performance)),v=s||u,C=n||E.connected||p.domElement,U=(0,i.useMemo)((()=>new At(v)),[v]);return(0,r.A)(((t,e)=>{U.enabled&&U.update(e)}),-1),(0,i.useEffect)((()=>(U.connect(C),()=>{U.disconnect()})),[C,U]),(0,i.useEffect)((()=>{const t=t=>{f(),d&&T.regress(),_&&_(t)},e=t=>{l&&l(t)},s=t=>{c&&c(t)};return U.addEventListener("update",t),U.addEventListener("controlstart",e),U.addEventListener("controlend",s),U.addEventListener("control",t),U.addEventListener("transitionstart",t),U.addEventListener("wake",t),()=>{U.removeEventListener("update",t),U.removeEventListener("controlstart",e),U.removeEventListener("controlend",s),U.removeEventListener("control",t),U.removeEventListener("transitionstart",t),U.removeEventListener("wake",t)}}),[U,l,c,f,g,d,_]),(0,i.useEffect)((()=>{if(h){const t=y().controls;return O({controls:U}),()=>O({controls:t})}}),[h,U]),i.createElement("primitive",(0,o.Z)({ref:e,object:U},m))}));var Pt=s(2695);const Rt=(t,e,s)=>new a.Vector3(t,e,s);var Ft=()=>{const t=(0,i.useCallback)((t=>{s[t]()}),[]),e=(0,i.useRef)(null),s=(new Event("open-left-shoji"),{}),r=(0,i.useCallback)(((t,e)=>{s[t]=e}),[]),o=(0,i.useCallback)((t=>{t&&(e.current=t)}),[]);return(0,Pt.BX)(P,{id:"canvas",ref:o,children:[(0,Pt.tZ)("directionalLight",{position:new a.Vector3(-40,0,10),args:[16777215,1.2],castShadow:!1}),(0,Pt.tZ)("directionalLight",{position:new a.Vector3(40,0,10),args:[16777215,1.2],castShadow:!1}),(0,Pt.BX)(i.Suspense,{fallback:(0,Pt.tZ)(n.uv,{position:Rt(-8,-.95,0),scale:Rt(.0125,.006,1),rotation:[0,0,0]}),children:[(0,Pt.tZ)(n.e8,{}),(0,Pt.tZ)(n.KA,{registerEventListener:r,dispatch:t}),(0,Pt.tZ)(n.h1,{dispatch:t,registerEventListener:r})]}),(0,Pt.tZ)(St,{enabled:!1})]})}}}]);
//# sourceMappingURL=component---src-pages-index-js-924c0d39a92131670c4c.js.map